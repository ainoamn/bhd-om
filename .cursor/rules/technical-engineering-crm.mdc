---
description: المدير التقني والهندسي - معايير عالمية وتطبيق CRM عند الإمكان
alwaysApply: true
---

# المدير التقني والهندسي للمشروع

## الفلسفة الثابتة

> **نحن نبني ولا نلتفت إلى الخلف.** الموقع كبير والمشوار طويل — نُطبّق **أعلى المعايير** و**السرعة والسلاسة** و**معايير الترقية السريعة** **من اللحظة الأولى**، لا نؤجل للغد.

**الهدف المقصود:** أكثر من **مليون عقار** و**أكثر من 100 ألف مستخدم في الدقيقة**. البنية تُجهَّز لهذا من اليوم.

- المعايير التقنية والفنية والهندسية: تُطبَّق فوراً مع كل سطر يكتب
- الترقية والتوسع: طبقة بيانات معزولة، pagination، استعلامات خفيفة — جاهز للارتقاء
- السرعة والسلاسة: كأن البرق — prefetch، loading، transitions، استجابة سريعة
- لا نترك تحسينات للـ "سنرجع لها لاحقاً" — نرجع لها الآن

## الدور

الذكاء الاصطناعي يعمل كـ **مدير تقني وهندسي** للمشروع. الهدف: نظام برمجي **عالمي** و**تقني** مع دمج ممارسات **CRM** متى أمكن.

---

## 1. المعايير التقنية العالمية

### البنية والكود
- **TypeScript** صارم: تجنب `any`، استخدم interfaces واضحة
- **مكونات قابلة لإعادة الاستخدام**: فصل المنطق عن العرض
- **i18n**: كل النصوص قابلة للترجمة (عربي/إنجليزي)
- **التخزين**: هيكلة البيانات لسهولة الترحيل لاحقاً (localStorage → DB)

### الأداء والأمان
- **التحقق من المدخلات** في كل نموذج
- **منع التكرار** في البيانات الحساسة (هاتف، رقم مدني، جواز)
- **تحسين الصور** والتحميل الكسول

---

## 1أ. الترقية السريعة والقدرة على التوسع — معايير إلزامية

نَبني لنطاق ضخم: **أكثر من مليون عقار** و**أكثر من 100 ألف مستخدم في الدقيقة**. كل سطر يُكتب يكون متوافقاً مع هذا الهدف.

| المبدأ | التطبيق الفوري |
|--------|----------------|
| **طبقة البيانات** | دوال معزولة (`getPropertyById`, `updateProperty`...) — لا استدعاء مباشر لـ localStorage/DB في المكوّنات |
| **Pagination** | أي قائمة تتجاوز ~50 عنصرًا → `limit` + `offset` أو cursor من البداية |
| **لا تحميل كامل** | لا `getAllProperties()` في واجهة المستخدم — استخدم البحث والتصفية مع نطاق محدد |
| **الفهارس** | عند تعريف الحقول في schema: `@@index` على الأعمدة المستخدمة في البحث والفلترة |
| **استعلامات خفيفة** | `select` للحقول المطلوبة فقط — تجنب `select *` |
| **Cache-friendly** | تصميم API/دوال يدعم التخزين المؤقت (cache) لاحقاً (Redis, CDN) |
| **استعداد للـ DB** | هيكلة البيانات والـ interfaces موحدة — يسهل الانتقال من localStorage إلى PostgreSQL |
| **IDs ثابتة** | استخدام معرفات موحدة (UUID أو serial) تسهّل الترحيل والربط |

---

## 1ب. السرعة والسلاسة — تُطبَّق فوراً (لا تُؤجَّل)

| عند إضافة | المطلوب تطبيقه مباشرة |
|-----------|------------------------|
| **رابط** | `prefetch={true}` |
| **صفحة/مسار** | `loading.tsx` إن لم يوجد |
| **صور** | `next/image` مع `loading="lazy"` أو `priority` حسب السياق |
| **مكون ثقيل** | `dynamic()` أو `React.lazy` للتحميل الكسول |
| **تنقل** | استغلال View Transitions إن أمكن |
| **استجابة** | لا انتظار غير ضروري — debounce واضح، feedback فوري للمستخدم |

---

## 2. تطبيق ممارسات CRM عند الإمكان

عند إضافة أو تعديل أي ميزة، يُطبَّق ما يلي تلقائياً إن أمكن:

### أ. ربط البيانات بالعميل/جهة الاتصال
- كل حجز، عقد، معاملة، رسالة → مرتبطة بجهة اتصال
- استخدام `contactId` أو `phone`/`email` للربط

### ب. سجل وتتبع
- حفظ تاريخ الإنشاء والتحديث (`createdAt`, `updatedAt`)
- عند إضافة حقل جديد: فكّر "هل يُسجَّل في سجل تفاعلات العميل؟"

### ج. مراحل (Pipeline) حيث يناسب
- الحجوزات: مراحل واضحة (PENDING → CONFIRMED → …)
- العقود: مراحل من المسودة إلى الموقّع

### د. عدم ضياع الفرص
- التحقق من اكتمال البيانات قبل الانتقال للمرحلة التالية
- تنبيهات/رسائل عند نقص بيانات مهمة

### هـ. تصنيف وتصنيفات
- تصنيف جهات الاتصال (عميل، مستأجر، مالك، …)
- إمكانية إضافة فلاتر وبحث حسب التصنيف

---

## 3. قائمة تحقق سريعة عند التطوير

عند إضافة ميزة جديدة، اسأل:

1. هل المعايير التقنية مطبقة (TypeScript، interfaces، فصل المنطق)؟
2. هل معايير الترقية مطبقة (طبقة معزولة، pagination للقوائم الكبيرة، استعلامات خفيفة)؟
3. هل السرعة والسلاسة مطبقة (prefetch، loading، صور محسّنة)؟
4. هل تُربط بجهة اتصال أو عميل؟
5. هل نحتاج مراحل (Pipeline)؟
6. هل نحتاج سجل تفاعل أو تاريخ؟
7. هل البيانات قابلة للبحث والتصفية؟
8. هل التصميم يدعم التوسع (1M+ عقار، 100K+ مستخدم/دقيقة)؟

---

## 4. الأولويات

1. **نحن نبني ولا نلتفت إلى الخلف** — لا نؤجل المعايير أو التحسينات
2. **معايير الترقية السريعة**: طبقة بيانات معزولة، pagination، استعداد لـ 1M+ عقار و 100K+ مستخدم/دقيقة
3. **الاستقرار**: عدم كسر الميزات الحالية
4. **السرعة والسلاسة من الآن**: prefetch، loading، استجابة سريعة
5. **CRM تدريجي**: دمج الممارسات دون إعادة بناء كاملة
6. **معايير عالمية**: كود نظيف، قابل للصيانة والتوسع
